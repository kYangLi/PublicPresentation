# 计算物理讨论班[第一次]: Linux系统由来与使用

## Linux系统的历史

### 1969年之前, Multics

早期计算机编程依赖于纸带和打卡机完成, 编程周期极长, 时间成本极大(打错一个孔就要全部从头再来). 且计算机一次只能运行一个''程序''(一次只能读一个纸带), 计算机资源十分有限. 编程者的大部分时间都花在打孔和排队等待上.

之后磁带代替了纸带, CTSS(Compatible Time-Sharing System, 兼容分时系统)横空出世, 计算机支持多进程并行计算, 给人以"计算机可以同时跑多个程序的错觉"(因为CPU在同一时间还是只能做一个运算, CTSS实际上是把各个任务排序, 在极短的时间内使其相互轮流进行). ("终端"概念出现)  

但此时, 即便有了终端, 计算资源也仍然十分有限. 因为即使是当时最先进的计算机, 最多也只是支持不到30个终端同时运行.

为了进一步发掘计算资源, 1965年(此时中国正在文革), Bell实验室, MIT, 奇异公司(GE, 或称为美国通用电气公司)共同发起了名为"*Multics*"计划. 该计划的目标是通过在操作系统方面的调整, 让一台主机有能力支持300个以上的终端. 但由于种种原因, 1969年Bell实验室退出了研发, 该计划也被迫延后.

后来, 虽然*Multics*成功研制出来, 但也并没有引起社会的太多关注. *Multics*计划最大的成功之处是: 培养了一大批有idea有能力的计算机内核工程师!

### 1969年, Ken Thompson 的 File Server System

虽然认定了Multics计划不可能成功的Bell实验室退出了该计划, 但原本参与计划的Ken Thompson却从*Multics*计划中获得了一些灵感.

当时Thompson正沉迷于一款名为**太空旅游**的游戏. 但该游戏无法在他的机器(DEC公司开发的PDP-7)上运行. 此时又正赶上他的妻子回美国西部探亲. 于是, Thompson有了一个月无聊的单身时间.

因此, 这一个月内, 他起早贪黑, 最终以汇编语言Assembler写出了一组核心程序、一些核心工具程序, 以及一个小小的文件系统. 

这个小小的文件系统被他的同事们戏称*Unics*, 因为他更像是一个微缩版简化版的*Multics*系统.

这个被同事们称为"*Unics*"的文件系统由两个特点:

* 所有的程序和系统都是文件, 驱动硬件也是!
* 不管建构编辑器还是附属文件, 所写每个程序只有唯一的目的, 且要有效的完成目标.

这两点深深的影响到了后来的Linux系统以及C语言.

### 1973年, C语言诞生 (文革即将结束)

Thompson写的程序太好用了! 导致其在Bell实验室风靡一时. 唯一的缺点是它是由汇编语言写成的, 而汇编语言具有专一性, 也就是对于不同构架的计算机, 所使用的汇编语言语法是完全不同的! (你兴高采烈地搞到了一个最新款的服务器, 却发现用不了最好用的系统. 只能自己动手按照源码重构语言...)

因此, Thompson与Ritchie合作试图将*Unics*用**高级语言**写出来. 这样就可以极大地提高程序的兼容性.

然而...当时现成的语言只有B语言(Basic语言, 也就是比尔盖茨最喜欢的语言, 后来比尔盖茨还动用自己手下的一帮人将Basic语言精化为Visual Basic), 但是用B语言编出来的*Unics*性能很差, 不再像以前那么好用了...

因此, Ritchie将B语言改造为C语言, 再用C语言编译Unics核心. 这个版本的*Unics*正式更名为"*UNIX*". (Ritchie正是C语言之父.)

到此为止, 传奇的*Unix*系统和C语言就这样诞生了.

Bell实验室是隶属于AT&T的, 自己旗下的Bell实验室的一群工程师自娱自乐而做的*Unix*系统一开始并没有引起AT&T的太多重视.

但是对于学术界, Unix真可谓是研究人员的福利! 因为这段程序是开源(核心代码可随意查看)的, 可以任意改写并做学术之用. 直接汲取C语言创始人的智慧, 这是多么珍贵的一段代码!

伯克利大学的Bill Joy在取得了*Unix*源码之后, 对其进行一系列改造, 最终形成了*Unix*系统的一个重要分支系统 Berkeley Software Distribution (BSD) 系统.

AT&A也发展了自己的*Unix*系统分支 system V.

此时所有的 *Unix*均只支持服务器和大型工作站.

### 1979年 AT&T的版权宣告(改革开放&对越自卫反击战)

*Unix*出现后, 以一种难以置信的速度在计算机界发展. AT&T公司见如此态势, 立刻推出适用于个人电脑的system V 7.0, 并特别声明了该版本的*Unix*系统将用于商业, "不得对学生提供源码!"

### 1984年 Minix

AT&T公司的版权宣言可苦了正在修相关课程的老师和学生.

谭宁帮教授为了解决学生的上课问题, 自己完全独立的(也就是不看Unix源码, 从零开始)编写了一个名为Minix的系统, 用了两年时间, 终于完成.

只需要缴纳极少的费用就可以获取*Minix*全部源码. (毕竟教授也是要恰饭的)

而且, 由于Minix只是做学术学习只用, 很多地方都是点到为止, 实用性并不强.

### 还是1984年 GNU计划

稍微了解一下计算机的历史, 就不会不认识计算机界天才式的人物 Stallman. Stallman 18岁就进入著名的人工智能实验AI LAB. 后来人工智能实验室解体, 斯托曼的雄心壮志并未结束.

斯托曼认为, 写程序的最大乐趣在于自己编写的有软件能够给大家由良好的使用体验. 既然程序是分享给大家使用的, 所以程序的源码应该与程序一同发布!

也就是说, 你写程序不仅仅是分享用程序的快乐, 还要分享你编程时的喜怒哀乐.
这就是自由软件(FreeSoftware)运动(注意不是免费软件哦!). (The Free here is not a free beer, but the free speech!)

而且, 如果释出源码, 加上你的软件很好用,那么就会有更多的人来帮你修改, 你的软件会越来越强, 流芳百世也不是没有可能.

1986年 斯托曼开始自己的GUN计划. GUN计划很简单: 建一个开放自由的Unix操作系统. 也就是和Minix性质差不多, 但是这个更专业. 但是一个人想改变整个计算机界的风气! 谈何容易.  

于是, 斯托曼采用了曲线救国的策略.  

首先, 他编写了一个Unix上相当好用的编辑器Emacs(即使是现在也是这样). 大获成功! 一个小软件还是难不倒一个计算机大师的. Emacs实在是太好用了! 很多人都直接联系斯托曼索要Emacs软件, 并提供了一笔可观的费用. 斯托曼借着出售Emacs的磁带大赚了一笔, 并有更多时间和精力去实现自己的GNU计划了.

期间, 斯托曼又完成了另一壮举, 1990年左右, 他成功写出了GCC这一史诗级C语言编译软件. 至此, GNU计划名声大噪.

### 1991年 Linux

1991年的某一天, 芬兰大学学生的 Linus Torvalds 在校内BBS上发表了一篇公告, 说他抱着在386机器上玩一玩的心态, 参考Minix系统, 编写了一个操作系统, 这并不是像GNU那样伟大计划, 但希望有大神的话可以带他一起玩.

由于托瓦兹存放在网站上存放文件的位置叫 Linux. 所以, 以后的大家就都把这个小小的操作系统叫做Linux了!

后来, Linux就像滚雪球一样,越来越大, 参与修改的人员越来越多. 核心也越来越健全.

而另一方面, GNU的创始人斯托曼也注意到了这个小小的荷兰学生托瓦兹所写的Linux. 这让他眼前一亮! 因为GNU计划就是缺一个健全的计算机内核!

之后GNU的大多数软件都以Linux为平台制作开发. 有了GNU计划强大后盾的支持, Linux的名望也越来越大.

后来一些公司直接将Linux核心加那些支持Linux的软件打包成成套的安装系统(称为"发行版", Release.).

Ubuntu就是其中之一.

## Linux VS Windows

1. Windows下系统崩了,你要骂微软; Linux下系统崩了你只能骂自己

2. 是免费开源的
 "可以用盗版windows啊!不一样么...我们都是为了学术啊!"  
 "这 话 你 留 着 跟 法 官 去 说!"

3. 自定义极高
 嘿嘿, 哪天不高兴可以试一试, 嘿嘿嘿.

```shell
su rm -rf /
```

4. 完全不用担心病毒什么的.

5. 删除程序文件 真的只用 删除程序文件  
***萌新三连:残余文件呢?注册表呢?历史记录呢?(ﾟДﾟ≡ﾟдﾟ)!?***  
***大佬三连:没有!不存在的!已经删啦!（￣▽￣）***  
***蠢萌三连:怎么回事,怎么搞的,我要学._(:3」∠)_***  

6. 不用担心内存泄漏.  
"老夫的电脑, 连续开机两月不卡"

7. 用apt-get安装大多数软件(Mac使用homebrew)  
"windows上的latex怎么安啊!看教程好麻烦啊....官网在哪....用迅雷下载安装包么...镜像怎么打开, 哪个是安装程序啊! .bat么?什么"_lt"啊?啊!!!!要崩溃了!"  
"关上Windows, 打开Ubuntu, Ctrl+t 打开终端...对打开! 然后复制这个输进去!  

``` bash
sudo apt-get install texlive-full
```  
你只管输进去就行了, 按回车, 按下去.

再问...那啥!"

"哇, 程序安好了耶!"

8. 不能玩大多数游戏  
 "你不是说要戒游戏吗?给你机会!"

9. 从来不用磁盘整理,垃圾清理之类的  
"什么?怎么清理垃圾?微软和360共同训练出来的强迫症吧..."

10. 编程效率极高  
"说了咋还不信呢...不信自己写一段C程序用gcc编译编译跑一跑"

11. 说吧, 还用不用谷歌学术了, Youtube清单里的视频还看不看了

12. 有很大几率能体验到成就感   
"大家都来登录我刚写的网站啦!支持文献整理分享和WolframAlpha啦!"

13. 不适合行政办公和娱乐  
"什么? 怎么打开这个flv视频文件? 这位同学,我们现在讨论的是学术问题!"

14. **!!!特别注意!!!**  有一定几率会让你吃上官司! 如果你一开始学Linux的时候就满脑子想着搭站做网页这样的大新闻, 而自己又不是老手又没有老手指导...  
"什么?我的服务器被警告了! 原因是蓄意攻击索尼在东京的R4服务器, 什么鬼..."

## Linux 的文件系统

```bash
   /bin 二进制可执行命令
   /boot 存放系统启动所必须的文件
　　/dev 设备特殊文件
　　/etc 系统管理和配置文件
　　/etc/rc.d 启动的配置文件和脚本
　　/home 用户主目录的基点，比如用户user的主目录就是/home/user，可以用~user表示
　　/lib 标准程序设计库，又叫动态链接共享库，作用类似windows里的.dll文件
　　/sbin 系统管理命令，这里存放的是系统管理员使用的管理程序
　　/tmp 公用的临时文件存储点
　　/root 系统管理员的主目录（呵呵，特权阶级）
　　/mnt 系统提供这个目录是让用户临时挂载其他的文件系统。
　　/lost+found 这个目录平时是空的，系统非正常关机而留下“无家可归”的文件（windows下叫什么.chk）就在这里
　　/proc 虚拟的目录，是系统内存的映射。可直接访问这个目录来获取系统信息。
　　/var 某些大文件的溢出区，比方说各种服务的日志文件
　　/usr 最庞大的目录，要用到的应用程序和文件几乎都在这个目录。其中包含：
　　/usr/X11R6 存放X window的目录
　　/usr/bin 众多的应用程序
　　/usr/sbin 超级用户的一些管理程序
　　/usr/doc linux文档
　　/usr/include linux下开发和编译应用程序所需要的头文件
　　/usr/lib 常用的动态链接库和软件包的配置文件
　　/usr/man 帮助文档
　　/usr/src 源代码，linux内核的源代码就放在/usr/src/linux里
　　/usr/local/bin 本地增加的命令
　　/usr/local/lib 本地增加的库
```

SWAP分区: 虚拟内存  
绝对路径和相对路径  
隐藏文件

## Linux的安装

1. 准备好一个USB安装镜像 (软碟通)
2. 分出一块磁盘空间 (PE或是其他更正规的方法)
3. 关机开机F2安装  

如果您是第一次接触Linux系统, 建议找一下懂这方面的人指导装机, 不然会有格式化全盘的风险.

## Linux 的使用

1. 几个基本的命令

```bash
cd
cd ../../../../../
ls
ls -all
ll
rm
rm -r
mv
cp
mkdir

alias

vim
cat
tail
./
echo $PATH

sudo
apt_get
wget
chmod +x

pwd
top
htop

sl
cowsay
cowthink
fortune

ssh
scp
ping

man
info

gcc
python
gnuplot
xelatex

mount
unmount

....and more...
```

会用"TAB"键...

## 如何正确使用Man

 ***有困难? 多找Man!***

### man page 边角的数字的意义

|代号|代表内容|
|----|----|
|1|用户在SHELL环境中可以操作的指令或可执行文件|
|2|系统核心可呼叫的函数与工具|
|3|一些常用的函数和依赖包, 多为C语言的依赖包|
|4|硬件文件的说明, ,通常是在/dev下的文件|
|5|配置文件或者是某些文件的格式|
|6|游戏|
|7|惯例与协议|
|8|系统管理员可执行的管理指令|
|9|和系统核心有关的文件|

### man page 的基本结构

|名称|内容说明|
|----|----|
|NAME|十分精简的指令和数据名称的说明|
|SYNOPSIS|简短的语法介绍|
|DESCRIPTION|完整的说明|
|OPTIONS|针对SYNOPSIS部分中[OPTIONS...]选项的说明和列举|
|COMMANDS|在这个程序中可以调用的指令|
|FILES|这个程序或者参考位于哪个文件中|
|SEE ALSO|可以参考的, 其他与此指令有关的指令|
|EXAMPLE|一些例子|
|BUGS|此程序的BUG|
|AUTHORS|此程序的作者|
|COPYRIGHT|此程序的版权信息|

对于一个给定的指令的man page并不是一定包含上述的所有结构

### 几个编辑器的讲解

vim  
vscode  
emacs  

### 讨论班的工具

1. 服务器
2. GitHub
3. GoogleGroups

#### 编辑器推荐

* vscode: 现代大师的作品

* Vim: 小巧耐用的终端文本编辑器

* Emacs: 古代大师的作品